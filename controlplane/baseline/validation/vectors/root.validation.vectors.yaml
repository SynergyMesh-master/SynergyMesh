# Root Validation Vectors
# Test vectors for validating the baseline validation system
# Part of: controlplane/baseline/validation

metadata:
  vectors_name: root-validation-vectors
  version: "1.0.0"
  description: "Test vectors for root namespace baseline validation"
  immutable: true

# Structural Validation Vectors
structural_vectors:
  
  directory_structure:
    description: "Test directory structure validation"
    test_cases:
      - name: "baseline_exists"
        input: "controlplane/baseline"
        expected: exists
        
      - name: "config_directory_exists"
        input: "controlplane/baseline/config"
        expected: exists
        
      - name: "specs_directory_exists"
        input: "controlplane/baseline/specifications"
        expected: exists
        
      - name: "registries_directory_exists"
        input: "controlplane/baseline/registries"
        expected: exists
        
      - name: "integration_directory_exists"
        input: "controlplane/baseline/integration"
        expected: exists
        
      - name: "validation_directory_exists"
        input: "controlplane/baseline/validation"
        expected: exists
        
      - name: "documentation_directory_exists"
        input: "controlplane/baseline/documentation"
        expected: exists
  
  file_existence:
    description: "Test file existence validation"
    test_cases:
      - name: "root_config_exists"
        input: "controlplane/baseline/config/root.config.yaml"
        expected: exists
        
      - name: "all_10_config_files"
        input: "controlplane/baseline/config/*.yaml"
        expected: count_equals_10
        
      - name: "all_5_spec_files"
        input: "controlplane/baseline/specifications/*.yaml"
        expected: count_equals_5
        
      - name: "all_2_registry_files"
        input: "controlplane/baseline/registries/*.yaml"
        expected: count_equals_2

# Syntax Validation Vectors
syntax_vectors:
  
  yaml_parsing:
    description: "Test YAML parsing validation"
    test_cases:
      - name: "valid_yaml_structure"
        input:
          metadata:
            name: test
          configuration:
            key: value
        expected: valid_yaml
        
      - name: "invalid_yaml_structure"
        input: "invalid: yaml: structure:"
        expected: invalid_yaml
  
  required_keys:
    description: "Test required key validation"
    test_cases:
      - name: "config_has_metadata"
        file: "controlplane/baseline/config/root.config.yaml"
        required_keys: ["metadata"]
        expected: all_keys_present
        
      - name: "specs_have_specifications"
        file: "controlplane/baseline/specifications/root.specs.context.yaml"
        required_keys: ["metadata", "specifications"]
        expected: all_keys_present

# Semantic Validation Vectors
semantic_vectors:
  
  naming_consistency:
    description: "Test naming policy consistency"
    test_cases:
      - name: "valid_module_name"
        input: "kernel.core.scheduler"
        policy: "^[a-z]+\\.[a-z]+\\.[a-z]+$"
        expected: matches_policy
        
      - name: "invalid_module_name"
        input: "Kernel.Core.Scheduler"
        policy: "^[a-z]+\\.[a-z]+\\.[a-z]+$"
        expected: violates_policy
        
      - name: "valid_device_path"
        input: "/dev/sda1"
        policy: "^/dev/[a-z]+[0-9]*$"
        expected: matches_policy
  
  reference_resolution:
    description: "Test reference resolution"
    test_cases:
      - name: "module_reference_resolves"
        reference: "kernel.core.scheduler"
        registry: "controlplane/baseline/registries/root.registry.modules.yaml"
        expected: reference_found
        
      - name: "device_reference_resolves"
        reference: "/dev/sda"
        registry: "controlplane/baseline/registries/root.registry.devices.yaml"
        expected: reference_found
  
  trust_levels:
    description: "Test trust level consistency"
    test_cases:
      - name: "valid_trust_level"
        input: "system"
        valid_levels: ["system", "trusted", "untrusted"]
        expected: valid_level
        
      - name: "invalid_trust_level"
        input: "unknown"
        valid_levels: ["system", "trusted", "untrusted"]
        expected: invalid_level

# Integration Validation Vectors
integration_vectors:
  
  config_spec_alignment:
    description: "Test config-spec alignment"
    test_cases:
      - name: "naming_policy_matches_spec"
        config: "controlplane/baseline/config/root.naming-policy.yaml"
        spec: "controlplane/baseline/specifications/root.specs.naming.yaml"
        expected: aligned
        
      - name: "trust_policy_matches_governance"
        config: "controlplane/baseline/config/root.trust.yaml"
        spec: "controlplane/baseline/config/root.governance.yaml"
        expected: aligned
  
  module_device_consistency:
    description: "Test module-device consistency"
    test_cases:
      - name: "module_device_access_valid"
        module: "kernel.drivers.block"
        device: "/dev/sda"
        expected: access_allowed
        
      - name: "module_device_permissions_valid"
        module: "kernel.drivers.block"
        device: "/dev/sda"
        required_permission: "0660"
        expected: permission_valid
  
  cross_component:
    description: "Test cross-component integration"
    test_cases:
      - name: "module_in_registry"
        module: "kernel.core.scheduler"
        registry: "controlplane/baseline/registries/root.registry.modules.yaml"
        expected: registered
        
      - name: "module_follows_naming"
        module: "kernel.core.scheduler"
        policy: "controlplane/baseline/config/root.naming-policy.yaml"
        expected: compliant

# Security Validation Vectors
security_vectors:
  
  immutability:
    description: "Test immutability enforcement"
    test_cases:
      - name: "baseline_readonly"
        path: "controlplane/baseline"
        expected: readonly_enforced
        
      - name: "overlay_writable"
        path: "controlplane/overlay"
        expected: writable_allowed
  
  integrity:
    description: "Test integrity verification"
    test_cases:
      - name: "file_checksum_valid"
        file: "controlplane/baseline/config/root.config.yaml"
        expected: checksum_valid
        
      - name: "file_not_tampered"
        file: "controlplane/baseline/config/root.config.yaml"
        expected: not_modified
  
  provenance:
    description: "Test provenance tracking"
    test_cases:
      - name: "provenance_recorded"
        component: "root.config.yaml"
        expected: provenance_exists
        
      - name: "provenance_complete"
        component: "root.config.yaml"
        required_fields: ["created", "modified", "author"]
        expected: all_fields_present

# Edge Cases
edge_cases:
  
  empty_files:
    description: "Test handling of empty files"
    test_cases:
      - name: "empty_yaml_rejected"
        input: ""
        expected: validation_fails
  
  malformed_yaml:
    description: "Test handling of malformed YAML"
    test_cases:
      - name: "malformed_yaml_rejected"
        input: "key: [unclosed"
        expected: validation_fails
  
  circular_references:
    description: "Test handling of circular references"
    test_cases:
      - name: "circular_reference_detected"
        references:
          module_a:
            depends_on: module_b
          module_b:
            depends_on: module_a
        expected: circular_detected
  
  missing_references:
    description: "Test handling of missing references"
    test_cases:
      - name: "missing_reference_detected"
        reference: "nonexistent.module"
        registry: "controlplane/baseline/registries/root.registry.modules.yaml"
        expected: reference_not_found

# Performance Vectors
performance_vectors:
  
  validation_speed:
    description: "Test validation performance"
    test_cases:
      - name: "small_file_validation"
        file_size: "1KB"
        expected_time: "<100ms"
        
      - name: "large_file_validation"
        file_size: "1MB"
        expected_time: "<1s"
  
  memory_usage:
    description: "Test memory usage"
    test_cases:
      - name: "validation_memory_reasonable"
        expected_memory: "<100MB"

# Expected Outcomes
expected_outcomes:
  
  all_pass:
    description: "All validation checks should pass"
    criteria:
      - structural_validation: pass
      - syntax_validation: pass
      - semantic_validation: pass
      - integration_validation: pass
      - security_validation: pass
    
  evidence_generated:
    description: "Evidence should be generated"
    artifacts:
      - validation_report
      - test_results
      - integrity_checksums
      - audit_log
    
  report_complete:
    description: "Validation report should be complete"
    required_sections:
      - summary
      - detailed_results
      - failed_checks
      - warnings
      - recommendations

# Validation Metadata
validation_metadata:
  total_vectors: 50
  critical_vectors: 20
  warning_vectors: 15
  info_vectors: 15
  
# Test Execution
execution:
  parallel: false
  stop_on_failure: false
  generate_evidence: true
  verbose_output: true